#this page describes the best layout for your system disk and data-warehouse

= Introduction =

Disk layout is important, all the way down to the way you raid out your physical drives. On top of that, you should use LVM where-ever possible in case you run out of space. By default, the best bang for your buck is RAID5, as it will give you a good combination of performance and redundancy.

Where possible, you should:

 # mirror the main OS on it's own set of disks
 # mirror the main archive table space on it's own set of disks (it will be smaller than all the index tables, which can be rebuilt from the archive
 # RAID5 or even RAID0 the archive index table space
 # RAID5 or RAID0 the main database index table space (table indicies)

= Details =
== Example Layout ==
{{{
/dev/mapper/vg00-root  6.5G  2.2G  4.0G  35% /
tmpfs                 2.0G     0  2.0G   0% /lib/init/rw
udev                  2.0G   96K  2.0G   1% /dev
tmpfs                 2.0G     0  2.0G   0% /dev/shm
/dev/sda1             228M   31M  186M  15% /boot
/dev/mapper/vg00-home  4.6G  200M  4.2G   5% /home
/dev/mapper/vg01-archive 530G   1G  529G  1% /mnt/archive
/dev/mapper/vg02-index 470G   1G  469G  1% /mnt/index
}}}
== Partition Mapping ==
 1. your index should grow at a rate of 80% of your archive
 1. the archive partition should be about 55% of your disk
 1. the index logical volume should be about 45% of your disk
 1. for 1GB of free space:
  * 550MB for the archive
  * 450MB for your index
 1. for 1TB of free space:
  * 550GB for the archive
  * 450GB for the index
== LVM Example ==
 1. the /etc/fstab would look like:
{{{
/dev/mapper/vg00-archive /mnt/archive            ext3    defaults        0       2
/dev/mapper/vg00-index /mnt/index            ext3    defaults        0       2
}}}
 1. after you've created your system via lvm, assuming your "data volume" is on vg00:
{{{
$ sudo lvcreate -n archive -L 550G vg00
$ sudo lvcreate -n index -L 450G vg00
$ sudo mkdir /mnt/archive
$ sudo mkdir /mnt/index
$ sudo mke2fs -j -m 2 /dev/mapper/vg00-index
$ sudo mke2fs -j /dev/mapper/vg00-archive
$ sudo mount /mnt/archive
$ sudo mount /mnt/index
$ sudo chown postgres:postgres /mnt/archive /mnt/index
$ sudo chmod 750 /mnt/archive /mnt/index
}}}