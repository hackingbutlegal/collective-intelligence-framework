package CIF::WebAPI::malware::malware;
use base 'CIF::WebAPI';

use strict;
use warnings;

#use CIF::Message::Malware;

#sub GET {
#    my ($self, $request, $response) = @_;
#
#    my $hash = $self->hashid();
#    my $htype = (length($hash) == 32) ? 'hash_md5' : 'hash_sha1';
#    my $sql = qq{
#        WHERE lower($htype) = '$hash'
#        ORDER BY detecttime DESC, created DESC, id DESC
#        LIMIT 5000
#    };
#    my @recs = CIF::Message::Malware->retrieve_from_sql($sql);
#    unless(@recs){
#        return Apache2::Const::HTTP_OK;
#    }
#
#    my @res = map { CIF::WebAPI::malware::mapIndex($_) } @recs;
#
#    $response->data()->{'result'} = \@res;
#    return Apache2::Const::HTTP_OK;
##}

1;
