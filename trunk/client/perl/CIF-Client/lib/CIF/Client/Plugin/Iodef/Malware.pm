package CIF::Client::Plugin::Iodef::Malware;

sub hash_simple {
    my $class = shift;
    my $hash = shift;

    my ($sha1,$md5);
    my $ad = $hash->{'EventData'}->{'AdditionalData'};
    return unless($ad);
    my @array;
    if(ref($ad) eq 'ARRAY'){
        @array = @$ad;
    } else {
        push(@array,$ad);
    }
    foreach my $a (@array){
        for(lc($a->{'meaning'})){
            $md5    = $a->{'content'} if(/malware_md5/);
            $sha1   = $a->{'content'} if(/malware_sha1/);
        }
    }

    return({
        malware_sha1    => $sha1,
        malware_md5     => $md5,
    });
}
1;

